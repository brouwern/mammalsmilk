<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="4" style="list-style-type: lower-alpha">
<li>Data Exploration for Regression Analyses</li>
</ol> • mammalsmilk</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: lower-alpha">
</head>
<body>
<li>Data Exploration for Regression Analyses</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilk</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-introduction.html">a) Introduction to the mammals' milk case study</a>
    </li>
    <li>
      <a href="../articles/b1-data_access.html">b) Accessing mammalsmilk data</a>
    </li>
    <li>
      <a href="../articles/b2-data_cleaning.html">b) Data cleaning</a>
    </li>
    <li>
      <a href="../articles/c-data_subsetting.html">C) Data subsetting using dplyr</a>
    </li>
    <li>
      <a href="../articles/d-data_exploration.html">d) Data Exploration for Regression Analyses</a>
    </li>
    <li>
      <a href="../articles/e-PCA_data_vis.html">Data visualization &amp; exploration with PCA</a>
    </li>
    <li>
      <a href="../articles/f1-linear_reg_notes.html">f1) Linear regression notes</a>
    </li>
    <li>
      <a href="../articles/f2-linear_reg_fit_plot.html">f2) Running and plotting Linear Regression </a>
    </li>
    <li>
      <a href="../articles/f3-linear_reg_model_fit.html">f3) Linear regression as model fitting</a>
    </li>
    <li>
      <a href="../articles/z-building_a_package.html">z) Creating this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="4" style="list-style-type: lower-alpha">
<li>Data Exploration for Regression Analyses</li>
</ol></h1>
                        <h4 class="author">Nathan Brouwer | <a href="mailto:brouwern@gmail.com">brouwern@gmail.com</a> | <span class="citation">@lowbrowR</span>
</h4>
            
            <h4 class="date">2018-11-18</h4>
      
      
      <div class="hidden name"><code>d-data_exploration.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The data collated by Skibiel et al contain information on several components of milk, including fat, protein, sugar, and total energetic content (“energy”). Here we’ll look at multple y variables, though for most of the subsequent tutorials we’ll focus on % of fat in milk</p>
<p>The data also contains several “continous predictors” / covariates (x variables). These include</p>
<ul>
<li>size of mom = “mass.fem”</li>
<li>duration of pregnancy/gestation = “gest.mon”<br>
</li>
<li>how long young fed = “lacat.mo” (“number of lactation months”)<br>
</li>
<li>how big the babies are = “mass.litter”</li>
</ul>
<p>THere are also Several “categorical predictors”</p>
<ul>
<li>“diet” = meat, plants, everything</li>
<li>“arid” = desert or other; theory predicts arid environments impact evolution of milk</li>
<li>“biome” = aquatic or terrestrial (includes bats as terrestrial)</li>
</ul>
<p>Finally, there are columns containing taxonomic information</p>
<ul>
<li>order = order</li>
<li>fam = family</li>
<li>spp = species</li>
</ul>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(cowplot)
<span class="kw">library</span>(ggpubr)
<span class="kw">library</span>(arm)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(GGally)</code></pre></div>
</div>
<div id="loading-the-mammalsmilk-package" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-the-mammalsmilk-package" class="anchor"></a>Loading the mammalsmilk package</h3>
<p>If you haven’t already, download the mammalsmilk package from GitHub (note the “S” between mammal and milk). This is commented out in the code below - only run the code if you have never downloaded it before, or haven’t recently (in case its been updated)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install_github("brouwern/mammalsmilk")</span></code></pre></div>
<p>You can then load the package with library()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mammalsmilk)</code></pre></div>
</div>
</div>
<div id="load-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"milk"</span>)</code></pre></div>
</div>
<div id="data-exploration" class="section level2">
<h2 class="hasAnchor">
<a href="#data-exploration" class="anchor"></a>Data exploration</h2>
<p>Look at the data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Hom much data?</span>
<span class="kw">dim</span>(milk)</code></pre></div>
<pre><code>## [1] 130  19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#focal columns</span>
##(use negative indexing to drop some)
<span class="kw">summary</span>(milk[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">9</span>)])</code></pre></div>
<pre><code>##             ord        mass.fem            gest.mo           lac.mo      
##  Artiodactyla :23   Min.   :        8   Min.   : 0.400   Min.   : 0.300  
##  Carnivora    :23   1st Qu.:      857   1st Qu.: 1.405   1st Qu.: 1.625  
##  Primates     :22   Median :     5716   Median : 5.000   Median : 4.500  
##  Rodentia     :17   Mean   :  2229475   Mean   : 5.624   Mean   : 6.092  
##  Chiroptera   :10   3rd Qu.:   107500   3rd Qu.: 8.365   3rd Qu.: 8.225  
##  Diprotodontia:10   Max.   :170000000   Max.   :21.460   Max.   :42.000  
##  (Other)      :25                                                        
##   mass.litter               diet     arid            biome    
##  Min.   :      0.3   carnivore:32   no :91   aquatic    : 22  
##  1st Qu.:     42.0   herbivore:61   yes:39   terrestrial:108  
##  Median :    423.5   omnivore :37                             
##  Mean   :  52563.8                                            
##  3rd Qu.:   7038.2                                            
##  Max.   :2272500.0                                            
##                                                               
##        N           fat          gest.month        lacat.mo     
##  4      :13   Min.   : 0.20   Min.   : 0.400   Min.   : 0.300  
##  3      :11   1st Qu.: 4.65   1st Qu.: 1.405   1st Qu.: 1.625  
##  6      :10   Median : 8.55   Median : 5.000   Median : 4.500  
##  7      : 9   Mean   :13.99   Mean   : 5.624   Mean   : 6.092  
##  5      : 8   3rd Qu.:16.82   3rd Qu.: 8.365   3rd Qu.: 8.225  
##  24     : 5   Max.   :61.10   Max.   :21.460   Max.   :42.000  
##  (Other):74                                                    
##       prot            sugar           energy     
##  Min.   : 1.100   Min.   : 0.02   Min.   :0.360  
##  1st Qu.: 4.125   1st Qu.: 3.00   1st Qu.:0.965  
##  Median : 6.750   Median : 4.70   Median :1.365  
##  Mean   : 6.673   Mean   : 4.94   Mean   :1.680  
##  3rd Qu.: 9.200   3rd Qu.: 6.60   3rd Qu.:2.045  
##  Max.   :15.800   Max.   :14.00   Max.   :5.890  
##                   NA's   :16      NA's   :16</code></pre>
<div id="focal-families-in-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#focal-families-in-dataset" class="anchor"></a>Focal families in dataset</h3>
<p>This code is dense but let’s us look at the most common families</p>
<p>Tabulate number of families</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.fam &lt;-<span class="st"> </span><span class="kw">table</span>(milk<span class="op">$</span>fam)</code></pre></div>
<p>Determine order in data set (not taxonomic order)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">numeric.order. &lt;-<span class="st"> </span><span class="kw">order</span>(table.fam,
                        <span class="dt">decreasing =</span> T)</code></pre></div>
<p>Largest families, in order</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.fam &lt;-<span class="st"> </span><span class="kw">data.frame</span>(table.fam[numeric.order.][<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>])

<span class="kw">names</span>(table.fam) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"fam"</span>,<span class="st">"freq"</span>)

table.fam</code></pre></div>
<pre><code>##                fam freq
## 1          Bovidae   13
## 2  Cercopithecidae    8
## 3         Cervidae    7
## 4          Muridae    7
## 5        Otariidae    7
## 6         Phocidae    7
## 7        Lemuridae    5
## 8     Macropodidae    5
## 9     Pteropodidae    5
## 10 Balaenopteridae    4
## 11         Equidae    4
## 12         Canidae    3
## 13       Leporidae    3</code></pre>
<p>Plot as barplot; some added gplot code to rotate the axis lables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggbarplot</span>(<span class="dt">data =</span> table.fam,
          <span class="dt">y =</span> <span class="st">"freq"</span>,
          <span class="dt">x =</span> <span class="st">"fam"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, 
                                   <span class="dt">hjust =</span> <span class="dv">1</span>, 
                                   <span class="dt">vjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Tabulate number of orders</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.ord &lt;-<span class="st"> </span><span class="kw">table</span>(milk<span class="op">$</span>ord)</code></pre></div>
<p>Determine order (numeric order, not taxonomic order)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">numeric.order. &lt;-<span class="st"> </span><span class="kw">order</span>(table.ord,
                        <span class="dt">decreasing =</span> T)</code></pre></div>
<p>Largest orders, in order</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.ord &lt;-<span class="st"> </span><span class="kw">data.frame</span>(table.ord[numeric.order.][<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>])

<span class="kw">names</span>(table.ord) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"ord"</span>,<span class="st">"freq"</span>)

table.ord</code></pre></div>
<pre><code>##               ord freq
## 1    Artiodactyla   23
## 2       Carnivora   23
## 3        Primates   22
## 4        Rodentia   17
## 5      Chiroptera   10
## 6   Diprotodontia   10
## 7 Perrissodactyla    7
## 8         Cetacea    6
## 9      Lagomorpha    3</code></pre>
<ul>
<li>Artiodactyla = 23; Even-toed ungulate</li>
<li>Carnivora = 23</li>
<li>Primates = 22</li>
<li>Rodentia = 17</li>
<li>Chiroptera = 10; bats</li>
<li>Diprotodontia = 10; marsupials</li>
<li>Perrissodactyla = 7; odd-toed ungulates</li>
<li>Cetacea = 6</li>
<li>Lagomorpha = 3</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggbarplot</span>(<span class="dt">data =</span> table.ord,
          <span class="dt">y =</span> <span class="st">"freq"</span>,
          <span class="dt">x =</span> <span class="st">"ord"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, 
                                   <span class="dt">hjust =</span> <span class="dv">1</span>, 
                                   <span class="dt">vjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="plotting-scatter-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-scatter-plots" class="anchor"></a>Plotting scatter plots</h3>
<p>To condense my plotting code I will save titles and axis labels to R objects.</p>
<p>Note that for ylab. I insert a line break by putting a backslash in from of an n, for “new line”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">main. &lt;-<span class="st"> "Regression data: continous vs continuous"</span>
xlab. &lt;-<span class="st"> "Continous x: mass of female"</span>
ylab. &lt;-<span class="st"> "Continous y: </span><span class="ch">\n</span><span class="st">fat contenxt of milk"</span></code></pre></div>
<div id="look-at-milk-fat-vs-mass-of-female" class="section level4">
<h4 class="hasAnchor">
<a href="#look-at-milk-fat-vs-mass-of-female" class="anchor"></a>Look at % milk fat vs. mass of female</h4>
<p>Note that the plot is dominated an outlier, which the whales!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem"</span>,
      <span class="dt">data =</span> milk,
      <span class="dt">main =</span> main.,
      <span class="dt">xlab =</span> xlab.,
      <span class="dt">ylab =</span> ylab.)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>A similar graph can be made using the stock ggplot function qplot(), except the variables are not quoted</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> fat,       <span class="co"># no " " !</span>
      <span class="dt">x =</span> mass.fem,
      <span class="dt">data =</span> milk,
      <span class="dt">main =</span> main.,
      <span class="dt">xlab =</span> xlab.,
      <span class="dt">ylab =</span> ylab.) </code></pre></div>
</div>
</div>
</div>
<div id="look-at-milk-fat-vs-logmass-of-female" class="section level2">
<h2 class="hasAnchor">
<a href="#look-at-milk-fat-vs-logmass-of-female" class="anchor"></a>Look at milk fat vs. log(mass of female)</h2>
<ul>
<li>Logging helps linearize the data</li>
<li>NOTE: statiticians typically use natural log = ln()</li>
<li>Biologists, especially when allometry is invovled, typically use base 10 = log10()</li>
<li>Original authors used log10, but I just realized this, so I’ll stick with ln()</li>
<li>I believe (?) give similar answers, but log10 I think (?) makes biological interpretation easier (???)</li>
<li>ggpubr requires hard-coded variables and can’t do the log transform “on the fly” in the same way as ggplot/qplot</li>
</ul>
<p>We can use the mutate() function in dplyr to take the log.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk &lt;-<span class="st"> </span>milk <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">mass.fem.log =</span> <span class="kw">log</span>(mass.fem))</code></pre></div>
<p>Look at transformed data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(milk<span class="op">$</span>mass.fem.log)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.079   6.753   8.651   9.105  11.584  18.951</code></pre>
<p>Plot transformed data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">main.new &lt;-<span class="st">"Regression data: continous vs log(continuous)"</span> 

<span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">data =</span> milk,
      <span class="dt">main =</span> main.new,
      <span class="dt">ylab =</span> ylab.,
      <span class="dt">xlab =</span> xlab.)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="add-smoother" class="section level2">
<h2 class="hasAnchor">
<a href="#add-smoother" class="anchor"></a>Add “smoother”</h2>
<p>Helps visualize trends</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">add =</span> <span class="st">"loess"</span>,     <span class="co">#smoother</span>
      <span class="dt">data =</span> milk,
      <span class="dt">main =</span> main.new,
      <span class="dt">ylab =</span> ylab.,
      <span class="dt">xlab =</span> xlab.)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div id="look-at-milk-fat-by-a-categorical-variable-diet" class="section level2">
<h2 class="hasAnchor">
<a href="#look-at-milk-fat-by-a-categorical-variable-diet" class="anchor"></a>Look at % milk fat by a categorical variable (diet)</h2>
<p>Color-code diets. This might take a second to render.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">color =</span> <span class="st">"diet"</span>,
      <span class="dt">add =</span> <span class="st">"loess"</span>,
      <span class="dt">data =</span> milk,
      <span class="dt">main =</span> main.new,
      <span class="dt">ylab =</span> ylab.,
      <span class="dt">xlab =</span> xlab.)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div id="look-at-milk-fat-by-diet-and-biome-using-facets" class="section level2">
<h2 class="hasAnchor">
<a href="#look-at-milk-fat-by-diet-and-biome-using-facets" class="anchor"></a>Look at % milk fat by diet and biome using facets</h2>
<ul>
<li>“facets” are a powerful tool in ggplot</li>
<li>Turns out ALL of our aquatic spp are carnivores (sorry, no manatees)</li>
<li>This shows that “aquatic” and “diet” are “Confounded”</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">color =</span> <span class="st">"diet"</span>,
      <span class="dt">facet.by =</span> <span class="st">"biome"</span>, <span class="co"># facet command</span>
      <span class="dt">data =</span> milk,
      <span class="dt">main =</span> main.new,
      <span class="dt">ylab =</span> ylab.,
      <span class="dt">xlab =</span> xlab.)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div id="boxplots" class="section level2">
<h2 class="hasAnchor">
<a href="#boxplots" class="anchor"></a>Boxplots</h2>
<p>It can be useful to make boxplot just by categorical variables. For me, this plot highlights that almost all carnivores are aquatic, and they have a wide range of fat contents.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggboxplot</span>(<span class="dt">data =</span> milk,
          <span class="dt">add =</span> <span class="st">"jitter"</span>,
          <span class="dt">color =</span> <span class="st">"biome"</span>,
          <span class="dt">y =</span> <span class="st">"fat"</span>,
          <span class="dt">x =</span><span class="st">"diet"</span>)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div id="focal-data-subset-primates-relatives" class="section level2">
<h2 class="hasAnchor">
<a href="#focal-data-subset-primates-relatives" class="anchor"></a>Focal data subset: Primates &amp; Relatives</h2>
<p>Let’s look at just a subset of the data * Primates * Rodents (this is why we use mouse models) * Rabbits</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"milk_primates"</span>)</code></pre></div>
<p>Compare original data and our working subset</p>
<ul>
<li>Original = 130 speices</li>
<li>Working data = 42</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Original data</span>
<span class="kw">dim</span>(milk)</code></pre></div>
<pre><code>## [1] 130  20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#out working subset</span>
<span class="kw">dim</span>(milk_primates)</code></pre></div>
<pre><code>## [1] 42 15</code></pre>
</div>
<div id="plot-working-data-milk-fat-female-size" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-working-data-milk-fat-female-size" class="anchor"></a>Plot working data: milk fat ~ female size</h2>
<p>Do log transform</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_primates &lt;-<span class="st"> </span>milk_primates <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">mass.fem.log =</span> <span class="kw">log</span>(mass.fem))</code></pre></div>
<p>Make scatterplot; <strong>ggscatterhist()</strong> allows plots to be put in margin</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatterhist</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="dt">margin.plot =</span> <span class="st">"boxplot"</span>) </code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div id="add-labels" class="section level2">
<h2 class="hasAnchor">
<a href="#add-labels" class="anchor"></a>Add labels</h2>
<p>This code is fairly dense. What I’ll do is annotate some selected data points with the species names.</p>
<p>First, make some labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#make column to hold particular spp.names</span>
milk_primates<span class="op">$</span>spp.focal &lt;-<span class="st"> ""</span>

<span class="co">#select spp of interest</span>
## This is just accross a span of the data
i.focal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">23</span>,<span class="dv">30</span>,<span class="dv">34</span>,<span class="dv">39</span>)

<span class="co">#look at focals</span>
milk_primates<span class="op">$</span>spp.focal[i.focal]</code></pre></div>
<pre><code>## [1] "" "" "" "" "" "" ""</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#add spp names to spp.focal column</span>
milk_primates<span class="op">$</span>spp.focal[i.focal] &lt;-<span class="st"> </span><span class="kw">as.character</span>(milk_primates<span class="op">$</span>spp[i.focal])

milk_primates<span class="op">$</span>spp.focal &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"(^.*)( )(.*)"</span>,<span class="st">"</span><span class="ch">\\</span><span class="st">1"</span>,milk_primates<span class="op">$</span>spp.focal)</code></pre></div>
<p>plot with names using some fancier ggplot code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> milk_primates,
       <span class="kw">aes</span>(<span class="dt">y =</span> fat,
      <span class="dt">x =</span> mass.fem.log)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>spp.focal),
            <span class="dt">hjust=</span><span class="dv">1</span>, 
            <span class="dt">vjust=</span><span class="dv">0</span>)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div id="add-regression-line" class="section level2">
<h2 class="hasAnchor">
<a href="#add-regression-line" class="anchor"></a>Add regression line</h2>
<ul>
<li>% Fat generally declines as body mass increases</li>
<li>Grey areas is “confidence band”</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,   <span class="co">#regression line</span>
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>,    <span class="co">#confidence int.</span>
      <span class="dt">data =</span> milk_primates) </code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>Color code by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.fem.log"</span>,
      <span class="dt">color =</span> <span class="st">"ord"</span>,
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,   <span class="co">#regression line</span>
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>,    <span class="co">#confidence int.</span>
      <span class="dt">data =</span> milk_primates) </code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
<div id="alternate-predictors" class="section level2">
<h2 class="hasAnchor">
<a href="#alternate-predictors" class="anchor"></a>Alternate predictors</h2>
<p>We can also look at othe predictor besides the size of the mother, such as how many months are spent gestating.</p>
<p>First, we should log transform them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_primates &lt;-<span class="st"> </span>milk_primates <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">gest.mo.log =</span> <span class="kw">log</span>(gest.month),
    <span class="dt">lacat.mo.log =</span> <span class="kw">log</span>(lacat.mo),
    <span class="dt">mass.litter.log =</span> <span class="kw">log</span>(mass.litter))</code></pre></div>
<div id="duration-of-gestation" class="section level3">
<h3 class="hasAnchor">
<a href="#duration-of-gestation" class="anchor"></a>Duration of gestation</h3>
<p>Let’s look at a relationship fat ~ log(gest.month)</p>
<p>Compare all data compiled with by order</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#all data combined</span>
no.order &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"gest.mo.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="co">#color = "ord",</span>
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

<span class="co">#split by order</span>
by.order &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"gest.mo.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="dt">color =</span> <span class="st">"ord"</span>,
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

<span class="kw">plot_grid</span>(no.order,by.order)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>% Fat generally declines as gestation duration increases. So, the longer animal is pregnant, the less fatty the milk is. However, this trend largely disappears when we plot by order. That is because the Lagomorph data is vary noisy, resulting in a flat line. The negative trend seen when looking at all of the data combined is largely drive by the fact that lagomorphs tend to have higher milkfat and shorter gestations, and primates have lower milk fat and longer gestations. This trend is therefore probably driven mostly by differenes between orders, not due to an underlying relationship with gestation.</p>
</div>
</div>
<div id="duration-of-lactation" class="section level2">
<h2 class="hasAnchor">
<a href="#duration-of-lactation" class="anchor"></a>Duration of lactation</h2>
<p>Another relationship to consider fat ~ log(lacat.mo)</p>
<p>Compare all data compiled with by order</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">no.order &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"lacat.mo.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="co">#color = "ord",</span>
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

by.order &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"lacat.mo.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="dt">color =</span> <span class="st">"ord"</span>,
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

<span class="kw">plot_grid</span>(no.order,by.order)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>Overall, the % Fat generally declines as lactation duration increases. So, the longer time children are dependent, lower milk fat.</p>
<p>Again, however, there is strong phyolgenetic single. Within</p>
</div>
<div id="mass-of-litter" class="section level2">
<h2 class="hasAnchor">
<a href="#mass-of-litter" class="anchor"></a>Mass of litter</h2>
<p>fat ~ log(mass.litter)</p>
<ul>
<li>% Fat generally declines as litter size increases</li>
<li>more or bigger babies, less milk fat</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">no.order &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.litter.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="co">#color = "ord",</span>
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

by.order &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(<span class="dt">y =</span> <span class="st">"fat"</span>,
      <span class="dt">x =</span> <span class="st">"mass.litter.log"</span>,
      <span class="dt">data =</span> milk_primates,
      <span class="dt">color =</span> <span class="st">"ord"</span>,
      <span class="dt">add =</span> <span class="st">"reg.line"</span>,
      <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)

<span class="kw">plot_grid</span>(no.order,by.order)</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div id="correlations-among-predictors" class="section level2">
<h2 class="hasAnchor">
<a href="#correlations-among-predictors" class="anchor"></a>Correlations among predictors</h2>
<p>ALl of the graphs of all of the predictors looked basically the same. One reason is that all of the predictors are highly correlated, so they are all basically indicating something similar about the animals.</p>
<p>We can get a sense for these correlations using the ggpairs() fucntion in the GGally package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vars. &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"fat"</span>,<span class="st">"gest.mo.log"</span>,
           <span class="st">"mass.fem.log"</span>,<span class="st">"lacat.mo.log"</span>  ,  <span class="st">"mass.litter.log"</span>)
GGally<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/GGally/topics/ggpairs">ggpairs</a></span>(<span class="dt">data =</span> milk_primates,
        <span class="dt">column =</span> vars.,
        <span class="dt">diag =</span><span class="ot">NULL</span> )</code></pre></div>
<p><img src="d-data_exploration_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#load-data">Load data</a></li>
      <li><a href="#data-exploration">Data exploration</a></li>
      <li><a href="#look-at-milk-fat-vs-logmass-of-female">Look at milk fat vs. log(mass of female)</a></li>
      <li><a href="#add-smoother">Add “smoother”</a></li>
      <li><a href="#look-at-milk-fat-by-a-categorical-variable-diet">Look at % milk fat by a categorical variable (diet)</a></li>
      <li><a href="#look-at-milk-fat-by-diet-and-biome-using-facets">Look at % milk fat by diet and biome using facets</a></li>
      <li><a href="#boxplots">Boxplots</a></li>
      <li><a href="#focal-data-subset-primates-relatives">Focal data subset: Primates &amp; Relatives</a></li>
      <li><a href="#plot-working-data-milk-fat-female-size">Plot working data: milk fat ~ female size</a></li>
      <li><a href="#add-labels">Add labels</a></li>
      <li><a href="#add-regression-line">Add regression line</a></li>
      <li><a href="#alternate-predictors">Alternate predictors</a></li>
      <li><a href="#duration-of-lactation">Duration of lactation</a></li>
      <li><a href="#mass-of-litter">Mass of litter</a></li>
      <li><a href="#correlations-among-predictors">Correlations among predictors</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
