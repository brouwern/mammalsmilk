<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>f3) Linear regression as model fitting • mammalsmilk</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="f3) Linear regression as model fitting">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilk</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-introduction.html">a) Introduction to the mammals' milk case study</a>
    </li>
    <li>
      <a href="../articles/b1-data_access.html">b) Accessing mammalsmilk data</a>
    </li>
    <li>
      <a href="../articles/b2-data_cleaning.html">b) Data cleaning</a>
    </li>
    <li>
      <a href="../articles/c-data_subsetting.html">C) Data subsetting using dplyr</a>
    </li>
    <li>
      <a href="../articles/d-data_exploration.html">d) Data Exploration for Regression Analyses</a>
    </li>
    <li>
      <a href="../articles/e-PCA_data_vis.html">Data visualization &amp; exploration with PCA</a>
    </li>
    <li>
      <a href="../articles/f1-linear_reg_notes.html">f1) Linear regression notes</a>
    </li>
    <li>
      <a href="../articles/f2-linear_reg_fit_plot.html">f2) Running and plotting Linear Regression </a>
    </li>
    <li>
      <a href="../articles/f3-linear_reg_model_fit.html">f3) Linear regression as model fitting</a>
    </li>
    <li>
      <a href="../articles/z-building_a_package.html">z) Creating this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>f3) Linear regression as model fitting</h1>
                        <h4 class="author">Nathan Brouwer | <a href="mailto:brouwern@gmail.com">brouwern@gmail.com</a> | <span class="citation">@lowbrowR</span>
</h4>
            
            <h4 class="date">2018-11-18</h4>
      
      
      <div class="hidden name"><code>f3-linear_reg_model_fit.Rmd</code></div>

    </div>

    
    
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="load-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h3>
<p>Install the mammals milk package if needed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install_github("brouwern/mammalsmilk")</span></code></pre></div>
<p>You can then load the package with library()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mammalsmilk)</code></pre></div>
<p>THe example data is milk_primates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"milk_primates"</span>)</code></pre></div>
<p>Log transformation makes things more linear.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#this could be done with dplyr::mutate() too</span>
milk_primates<span class="op">$</span>mass.fem.log &lt;-<span class="st"> </span><span class="kw">log</span>(milk_primates<span class="op">$</span>mass.fem)</code></pre></div>
</div>
<div id="load-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#load-libraries" class="anchor"></a>Load libraries</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggpubr)
<span class="co">#&gt; Loading required package: magrittr</span>
<span class="kw">library</span>(cowplot)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'cowplot'</span>
<span class="co">#&gt; The following object is masked from 'package:ggpubr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     get_legend</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ggsave</span>
<span class="kw">library</span>(bbmle)
<span class="co">#&gt; Loading required package: stats4</span>
<span class="kw">library</span>(broom)</code></pre></div>
</div>
</div>
<div id="linear-regression-as-model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-regression-as-model-fitting" class="anchor"></a>Linear regression as model fitting</h2>
<p>Fit 2 models</p>
<div id="null-model-ho-flat-line" class="section level3">
<h3 class="hasAnchor">
<a href="#null-model-ho-flat-line" class="anchor"></a>Null model (Ho): flat line</h3>
<ul>
<li>Null hypothesis: Y variable doesn’t vary with x variable</li>
<li>Null model in R: “fat ~ 1”</li>
<li>“~1” means fit model
<ul>
<li>w/ slope = 0</li>
<li>intercept = mean of response variable</li>
</ul>
</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm.null &lt;-<span class="st"> </span><span class="kw">lm</span>(fat <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
              <span class="dt">data =</span> milk_primates)</code></pre></div>
</div>
<div id="alternative-model-fat-logmass-fem" class="section level3">
<h3 class="hasAnchor">
<a href="#alternative-model-fat-logmass-fem" class="anchor"></a>Alternative model: fat ~ log(mass.fem)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm.mass &lt;-<span class="st"> </span><span class="kw">lm</span>(fat <span class="op">~</span><span class="st"> </span>mass.fem.log,
              <span class="dt">data =</span> milk_primates)</code></pre></div>
</div>
</div>
<div id="plot-both-models" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-both-models" class="anchor"></a>Plot both models</h2>
</div>
<div id="what-is-the-intercept-of-null-model" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-the-intercept-of-null-model" class="anchor"></a>What is the intercept of null model?</h2>
<p>The mean fat value is 8.6</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(milk_primates[,<span class="st">"fat"</span>])
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;   0.700   3.750   6.600   8.581  11.875  27.000</span></code></pre></div>
<p>plot</p>
</div>
<div id="compare-models-significance-test" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-models-significance-test" class="anchor"></a>Compare models: significance test</h2>
<p>Nested Models:</p>
<ul>
<li>Ha: y ~ -1.75*log(mass) + 20.5</li>
<li><p>Ho: y ~ 0*log(mass) + 8.6</p></li>
<li>Ha has TWO parameters (aka coefficients, betas)
<ul>
<li>Intercept = 20.515</li>
<li>Slope = -1.75</li>
</ul>
</li>
<li>Ho has ONE parameter
<ul>
<li>Intercept = 8.6</li>
<li>(Slope = 0, so it doesn’t count)</li>
</ul>
</li>
<li>Hypothesis can be formulated of 2 “nested models”
<ul>
<li>Applies to t-test, ANOVA, ANCOVA</li>
<li>A major difference between Hypothesis testing w/p-values and IT-AIC is that AIC doesn’t require models to be nested!</li>
</ul>
</li>
</ul>
</div>
<div id="hypothesis-test-of-nested-models-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#hypothesis-test-of-nested-models-in-r" class="anchor"></a>Hypothesis test of nested models in R</h2>
<ul>
<li>anova() command</li>
<li>carries out an F test for linear models</li>
<li>“likelihood ratio test” for GLMs/GLMMs
<ul>
<li>GLMM = generalized linear mixed models</li>
<li>Models w/random effects, blocking, repeated measures etc</li>
</ul>
</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#NOTE: order w/in anova() doesn't matter</span>
<span class="kw">anova</span>(lm.null, 
      lm.mass)
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: fat ~ 1</span>
<span class="co">#&gt; Model 2: fat ~ mass.fem.log</span>
<span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co">#&gt; 1     41 1942.8                                  </span>
<span class="co">#&gt; 2     40 1421.6  1    521.22 14.666 0.0004425 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<ul>
<li>Output of anova() is similar to content of summary()</li>
<li>I like to emphasize the testing of nested models</li>
<li>GLMs, GLMMs often can only be tested with anova()</li>
</ul>
</div>
<div id="examine-model-it-aic" class="section level2">
<h2 class="hasAnchor">
<a href="#examine-model-it-aic" class="anchor"></a>Examine model: IT-AIC</h2>
<div id="it-aic-background" class="section level3">
<h3 class="hasAnchor">
<a href="#it-aic-background" class="anchor"></a>IT-AIC background</h3>
<ul>
<li>“Information Theory- Akaike’s Information Criteria”</li>
<li>“Information Theory” is a general approach to investigating models</li>
<li>AIC is a particular information theory
<ul>
<li>Others: BIC, WAIC, FIC, DIC (Bayesian), …</li>
<li>seems like every statistician has one now</li>
</ul>
</li>
<li>AICc: correction for small samples size
<ul>
<li>Should always use AICc, but people often forget</li>
</ul>
</li>
<li>qAIC: correction for “overdispersion”
<ul>
<li>For GLMs (i.e.. logistic regression)</li>
</ul>
</li>
</ul>
</div>
<div id="aic-in-practice" class="section level3">
<h3 class="hasAnchor">
<a href="#aic-in-practice" class="anchor"></a>AIC in practice</h3>
<ul>
<li>Lower is “better”</li>
<li>Absolute values have NO MEANING</li>
<li>AICs are only interpretable relative to other AICs</li>
<li>focus: “delta AIC” (dAIC)</li>
<li>AIC goes down if a model fits the data better</li>
<li>BUT - every additional parameter has a “penalty”</li>
</ul>
</div>
</div>
<div id="aic-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#aic-in-r" class="anchor"></a>AIC in R</h2>
<div id="aic-in-base-r" class="section level3">
<h3 class="hasAnchor">
<a href="#aic-in-base-r" class="anchor"></a>AIC in base R</h3>
<p>The AIC() command in base R.</p>
<ul>
<li>Note: no AICc command in base R!</li>
<li>Other packages can do AICc and other ICs</li>
<li>DF = number of parameters</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">AIC</span>(lm.null, 
    lm.mass)
<span class="co">#&gt;         df      AIC</span>
<span class="co">#&gt; lm.null  2 284.2276</span>
<span class="co">#&gt; lm.mass  3 273.1082</span></code></pre></div>
</div>
<div id="aic-table-from-aictab" class="section level3">
<h3 class="hasAnchor">
<a href="#aic-table-from-aictab" class="anchor"></a>AIC table from AICtab</h3>
<p>AICtab() from the bbmle package is super handy. Can give AIC and dAIC. Also can do AICc (see below).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bbmle<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/bbmle/topics/ICtab">AICtab</a></span>(lm.null,
       lm.mass,
       <span class="dt">base =</span> T)
<span class="co">#&gt;         AIC   dAIC  df</span>
<span class="co">#&gt; lm.mass 273.1   0.0 3 </span>
<span class="co">#&gt; lm.null 284.2  11.1 2</span></code></pre></div>
</div>
<div id="aicc" class="section level3">
<h3 class="hasAnchor">
<a href="#aicc" class="anchor"></a>AICc</h3>
<ul>
<li>Use ICtab() with type = c(“AICc”)</li>
<li>AICc is a correction for small sample size</li>
<li>Doesn’t make much difference here</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bbmle<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/bbmle/topics/ICtab">ICtab</a></span>(lm.null,
      lm.mass,
      <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">"AICc"</span>),
      <span class="dt">base =</span> T)
<span class="co">#&gt;         AICc  dAICc df</span>
<span class="co">#&gt; lm.mass 273.7   0.0 3 </span>
<span class="co">#&gt; lm.null 284.5  10.8 2</span></code></pre></div>
</div>
</div>
<div id="what-about-r2" class="section level2">
<h2 class="hasAnchor">
<a href="#what-about-r2" class="anchor"></a>What about R^2?</h2>
<div id="hypothesis-testing" class="section level3">
<h3 class="hasAnchor">
<a href="#hypothesis-testing" class="anchor"></a>Hypothesis testing</h3>
<ul>
<li>p-values: tell if you if a predictor is “significantly” associated w/ a response</li>
<li>Does not tell you the EFFECT SIZE is large
<ul>
<li>p can be very very small</li>
<li>but slope also very small</li>
</ul>
</li>
</ul>
</div>
<div id="ic-aic" class="section level3">
<h3 class="hasAnchor">
<a href="#ic-aic" class="anchor"></a>IC-AIC</h3>
<ul>
<li>AIC tells you if one model fits the data better than another</li>
<li>but, AIC doesn’t tell you if either model fits the data very well.</li>
<li>So, even if a model has a low AIC relative to other models, it still might not be a very useful model!</li>
</ul>
</div>
<div id="r2" class="section level3">
<h3 class="hasAnchor">
<a href="#r2" class="anchor"></a>R^2</h3>
<ul>
<li>Tells you how much variation in the data is explained by model</li>
<li>whether you use p-values or AIC, you should report R^2</li>
</ul>
</div>
</div>
<div id="how-good-is-the-alternative-model" class="section level2">
<h2 class="hasAnchor">
<a href="#how-good-is-the-alternative-model" class="anchor"></a>How good is the alternative model?</h2>
<ul>
<li>Slope of Alt models is highly significant</li>
<li>But R2 isn’t huge…</li>
<li>Lots of scatter around line</li>
<li>Other predictors might fit better</li>
<li>Can also build models with multiple predictors used at the same time.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#linear-regression-as-model-fitting">Linear regression as model fitting</a></li>
      <li><a href="#plot-both-models">Plot both models</a></li>
      <li><a href="#what-is-the-intercept-of-null-model">What is the intercept of null model?</a></li>
      <li><a href="#compare-models-significance-test">Compare models: significance test</a></li>
      <li><a href="#hypothesis-test-of-nested-models-in-r">Hypothesis test of nested models in R</a></li>
      <li><a href="#examine-model-it-aic">Examine model: IT-AIC</a></li>
      <li><a href="#aic-in-r">AIC in R</a></li>
      <li><a href="#what-about-r2">What about R^2?</a></li>
      <li><a href="#how-good-is-the-alternative-model">How good is the alternative model?</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
