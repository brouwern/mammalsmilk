<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="5" style="list-style-type: lower-alpha">
<li>Data visualization &amp; exploration with PCA</li>
</ol> • mammalsmilk</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: lower-alpha">
</head>
<body>
<li>Data visualization &amp; exploration with PCA</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilk</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-introduction.html">a) Introduction to the mammals' milk case study</a>
    </li>
    <li>
      <a href="../articles/b1-data_access.html">b) Accessing mammalsmilk data</a>
    </li>
    <li>
      <a href="../articles/b2-data_cleaning.html">b) Data cleaning</a>
    </li>
    <li>
      <a href="../articles/c-data_subsetting.html">C) Data subsetting using dplyr</a>
    </li>
    <li>
      <a href="../articles/d-data_exploration.html">d) Data Exploration for Regression Analyses</a>
    </li>
    <li>
      <a href="../articles/e-PCA_data_vis.html">e) Data visualization &amp; exploration with PCA</a>
    </li>
    <li>
      <a href="../articles/f1-linear_reg_notes.html">f1) Linear regression notes</a>
    </li>
    <li>
      <a href="../articles/f2-linear_reg_fit_plot.html">f2) Running and plotting Linear Regression </a>
    </li>
    <li>
      <a href="../articles/f3-linear_reg_model_fit.html">f3) Linear regression as model fitting</a>
    </li>
    <li>
      <a href="../articles/g-linear_reg_diagnostics.html">g) Regression diagnostics</a>
    </li>
    <li>
      <a href="../articles/z-building_a_package.html">z) Creating this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="5" style="list-style-type: lower-alpha">
<li>Data visualization &amp; exploration with PCA</li>
</ol></h1>
                        <h4 class="author">Nathan Brouwer | <a href="mailto:brouwern@gmail.com">brouwern@gmail.com</a> | <span class="citation">@lowbrowR</span>
</h4>
            
            <h4 class="date">2018-11-18</h4>
      
      
      <div class="hidden name"><code>e-PCA_data_vis.Rmd</code></div>

    </div>

    
    
<div id="exploring-data-with-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-data-with-pca" class="anchor"></a>Exploring data with PCA</h2>
<p><strong>This tutorial is optional, some what esoteric, and not well organized</strong></p>
<ul>
<li>PCA is a very common “dimension reduction” tool</li>
<li>It can take several correlated variables and extact a smaller number of uncorrelated, “latent” variables</li>
<li>The math behind this is tricky, and the interpretation requires some practice</li>
<li>Getting good at PCA let’s you explore the structure of complex datasets</li>
<li>Using PCA, I found that Australian mammals are very distinct from all other species. This was alluded to in the original paper but did not factor into their analysis.</li>
<li>We’ll briefly do 2 PCAs
<ul>
<li>1st on the reponse variables (y) from the milk dataset (% fat, % protein, etc) and</li>
<li>2nd on the predictor variables (body mass, duration of gestation etc)</li>
</ul>
</li>
<li>This is just a very very very brief intro to the R functions and key vocab. There are several good tutorials online with more info.</li>
</ul>
</div>
<div id="important-commands" class="section level2">
<h2 class="hasAnchor">
<a href="#important-commands" class="anchor"></a>Important commands</h2>
<ul>
<li>pairs</li>
<li>princomp</li>
<li>biplot</li>
</ul>
</div>
<div id="load-cleaned-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-cleaned-data" class="anchor"></a>Load cleaned data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install_github("brouwern/mammalsmilk")</span></code></pre></div>
<p>You can then load the package with library()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mammalsmilk)</code></pre></div>
<p>Load data cleaned in previous tutorial</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"milk"</span>)</code></pre></div>
<div id="packages" class="section level3">
<h3 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(cowplot)</code></pre></div>
<pre><code>## 
## Attaching package: 'cowplot'</code></pre>
<pre><code>## The following object is masked from 'package:ggplot2':
## 
##     ggsave</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<div id="transformations" class="section level2">
<h2 class="hasAnchor">
<a href="#transformations" class="anchor"></a>Transformations</h2>
<p>Because the variables are on very different scales it helps to transform them</p>
<p>The old-school way of doingthis might be to do it column by column</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>gest.mo.log &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>gest.month)
milk<span class="op">$</span>repro.log &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>repro.output)
milk<span class="op">$</span>mass.litter.log &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>mass.litter)
milk<span class="op">$</span>lact.mo.log &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>lacat.mo)
milk<span class="op">$</span>mass.fem.log &lt;-<span class="st"> </span><span class="kw">log10</span>(milk<span class="op">$</span>mass.fem)</code></pre></div>
<p>In dplyr you can use the mutate() function from dplyr</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk &lt;-<span class="st"> </span>milk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">gest.mo.log =</span> <span class="kw">log</span>(gest.month),
                <span class="dt">repro.log =</span> <span class="kw">log</span>(repro.output),
                <span class="dt">mass.litter.log =</span> <span class="kw">log</span>(mass.litter),
                <span class="dt">lact.mo.log =</span> <span class="kw">log</span>(lacat.mo),
                <span class="dt">mass.fem.log =</span> <span class="kw">log</span>(mass.fem))</code></pre></div>
</div>
<div id="pairs-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#pairs-plot" class="anchor"></a>Pairs plot</h2>
<ul>
<li>Look for correlations among variables.</li>
<li>Many of the predictors are highly correlated.</li>
<li>Such collinearity among variables makes it difficult to build models w/multiple predictors</li>
<li>Instead you can only use one predictor at a time</li>
<li>These plots also indicate at curious cloud of points that typically occurs below the main point mass.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(milk[,<span class="kw">c</span>(<span class="st">"gest.mo.log"</span>,
          <span class="st">"repro.log"</span>,
    <span class="st">"mass.litter.log"</span>,
    <span class="st">"lact.mo.log"</span>,
    <span class="st">"mass.fem.log"</span>)],
    <span class="dt">lower.panel =</span> <span class="ot">NULL</span>)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Similar functionality can be done in ggplot using GGally::ggpairs()</p>
</div>
<div id="pca-on-predictor-x-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#pca-on-predictor-x-variables" class="anchor"></a>PCA on predictor (x) variables</h2>
<ul>
<li>Many of the predictors aer highly correlated</li>
<li>The predictors result in a PCA that is a bit easier to interpret</li>
</ul>
</div>
<div id="pca-on-predictory-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#pca-on-predictory-variables" class="anchor"></a>PCA on predictory variables</h2>
<p>Run the PCA with princomp()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#principal compoents</span>
pca.x.vars &lt;-<span class="st"> </span><span class="kw">princomp</span>(<span class="op">~</span><span class="st">  </span>gest.mo.log<span class="op">+</span>
<span class="st">                         </span>repro.log<span class="op">+</span>
<span class="st">    </span>mass.litter.log<span class="op">+</span>
<span class="st">    </span>lact.mo.log<span class="op">+</span>
<span class="st">    </span>mass.fem.log,
  <span class="dt">data =</span> milk)</code></pre></div>
</div>
<div id="biplot" class="section level2">
<h2 class="hasAnchor">
<a href="#biplot" class="anchor"></a>Biplot</h2>
<p>A biplot takes some time to learn how to read, a skill that is beyond this tutorial. It is easy to see unique underlying structures pop out in biplots. The group of points away from the main band will be shown below to be Australian mammals (marsupials etc)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">biplot</span>(pca.x.vars)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Plot w/o point by setting first color to 0</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">biplot</span>(pca.x.vars,<span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>The biplot tells us that a major axis of variation is female mass and lactation duration. These two variables are highly correlated. A 2nd major axis of variation is reproductive output, which is at a right angle to female mass/lactation. This implies that after accounting for female mass, there is additional, independent variation in the data due to reproduction. Litter size and gestation duration are at about a 45 degree angle between female maass reproduction. This implies another dimension of variation that is partially correlated with both of the other two.</p>
<p>PCA generates as many latent variables as there are original variables. Usually only the first few are useful. This codes displays the 2nd vs. the 3rd PCs</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">biplot</span>(pca.x.vars, 
       <span class="dt">choices =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), 
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>What a biplot is plotting are “PCA” scores. We can plot these by hand by extracting them from the list embedded in the PCA output object. I’ll use qplot() from ggplot to plot this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>] )</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>And add color code them to identify groups. It looks like that outlying group are Monotremata. Diprotodontia (marsupials), and Didelphimorphia (opossum).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>] ,
      <span class="dt">color =</span> milk<span class="op">$</span>ord)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>I can add labels to confirm</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">labs &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"ontia"</span>,<span class="st">""</span>,milk<span class="op">$</span>ord)
labs &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"ata"</span>,<span class="st">""</span>,milk<span class="op">$</span>ord)

<span class="kw">qplot</span>(<span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>] ,
      <span class="dt">color =</span> milk<span class="op">$</span>ord) <span class="op">+</span>
<span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"text"</span>, 
           <span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>] ,
           <span class="dt">label =</span> labs)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Make new variable for outliers</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i.weirdos &lt;-<span class="st"> </span><span class="kw">which</span>(milk<span class="op">$</span>ord <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Monotremata"</span>  <span class="co">#monotremes</span>
,<span class="st">"Diprotodontia"</span>  <span class="co">#marsupials</span>
,<span class="st">"Didelphimorphia"</span><span class="co">#opossums</span>
,<span class="st">"Dasyuromorphia"</span><span class="co">#tasmanian devil)</span>
,<span class="st">"Peramelemorphia"</span> <span class="co">#bandicoots</span>
)) 

milk<span class="op">$</span>Australia &lt;-<span class="st"> "other"</span>

milk<span class="op">$</span>Australia[i.weirdos] &lt;-<span class="st"> "Australia"</span>

<span class="kw">qplot</span>(<span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>] ,
      <span class="dt">color =</span> milk<span class="op">$</span>Australia) </code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>As noted above, PCA generates as many latent variables as there are original variables. Usually only the first few are useful. This codes displays the 2nd vs. the 3rd PCs</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.3"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
      <span class="dt">color =</span> milk<span class="op">$</span>Australia) </code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>And the 1st vs. the 3rd</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.3"</span>] ,
      <span class="dt">x =</span> pca.x.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>] ,
      <span class="dt">color =</span> milk<span class="op">$</span>Australia) </code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="pca-with-response-variables" class="section level1">
<h1 class="hasAnchor">
<a href="#pca-with-response-variables" class="anchor"></a>PCA with response variables</h1>
<p>This turns out to be an ugly biplot but I’ll do it anyway.</p>
<p>For each mammal species the authors found data on 5 different aspects of their milk</p>
<ul>
<li>fat %</li>
<li>protein %</li>
<li>sugar %</li>
<li>energy</li>
<li>dry.matter #removed somewhere - need to add back</li>
</ul>
<p>These things are frequently correlated. We can see this in a “pairs” plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(milk[,<span class="kw">c</span>(<span class="st">"fat"</span>,<span class="st">"prot"</span>,
            <span class="st">"sugar"</span>,<span class="st">"energy"</span>)],
      <span class="dt">lower.panel =</span> <span class="ot">NULL</span>)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>You can see that the percentage data (fat, protein, sugar) are negatively correlated b/c if a high fat percent must have a low fat percent, etc. These different columns of data therefore do not have independent information. PCA allows us to combine them to look for overal axes of variation.</p>
<div id="run-a-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#run-a-pca" class="anchor"></a>Run a PCA</h2>
<ul>
<li>There are 2 base R functions for PCA
<ul>
<li>princomp</li>
<li>prcomp</li>
</ul>
</li>
<li>There are important differences; I forget what they are</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk.noNA &lt;-<span class="st"> </span><span class="kw">na.omit</span>(milk)
pca.y.vars &lt;-<span class="st"> </span><span class="kw">princomp</span>(<span class="op">~</span><span class="st"> </span>fat <span class="op">+</span><span class="st"> </span>prot <span class="op">+</span>
<span class="st">                         </span>sugar <span class="op">+</span><span class="st"> </span>energy , 
                       <span class="dt">data =</span> milk.noNA)</code></pre></div>
</div>
<div id="make-biplot-of-response-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#make-biplot-of-response-variables" class="anchor"></a>Make biplot of response variables</h2>
<ul>
<li>biplots allow you to visualize axes of variation</li>
<li>These response variables is not a particularly great dataset for this because the %s are all so highly correlated.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">biplot</span>(pca.y.vars, 
       <span class="dt">cex =</span> <span class="fl">0.9</span>,
       <span class="dt">main =</span> <span class="st">"Milk y vars"</span>)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Make into dataframe</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Comp.3 =</span> pca.y.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.3"</span>] ,
                 <span class="dt">Comp.2 =</span> pca.y.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.2"</span>] ,
                 <span class="dt">Comp.1 =</span> pca.y.vars<span class="op">$</span>scores[ ,<span class="st">"Comp.1"</span>],
                 milk.noNA)</code></pre></div>
<p>Are the outliers Australian?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> Comp.<span class="dv">2</span> ,
      <span class="dt">x =</span> Comp.<span class="dv">1</span>,
      <span class="dt">color =</span> Australia,
      <span class="dt">data =</span> df)</code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Code by biome - outliers are Aqutic</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> Comp.<span class="dv">2</span> ,
      <span class="dt">x =</span> Comp.<span class="dv">1</span>,
      <span class="dt">color =</span> biome,
      <span class="dt">data =</span> df) </code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>Code by biome and diet - most (all?) aquatic organismsin the dataset are also carnivores, because most aquatic mammals are carnivores (exceptions? Manatees and …)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> Comp.<span class="dv">2</span> ,
      <span class="dt">x =</span> Comp.<span class="dv">1</span>,
      <span class="dt">color =</span> biome,
      <span class="dt">shape =</span> diet,
      <span class="dt">data =</span> df) </code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Facet by diet</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y =</span> Comp.<span class="dv">1</span> ,
      <span class="dt">x =</span> Comp.<span class="dv">3</span>,
      <span class="dt">color =</span> biome,
      <span class="dt">shape =</span> diet,
      <span class="co">#size = log(mass.fem),</span>
      <span class="dt">data =</span> df,
      <span class="dt">facets =</span> Australia <span class="op">~</span><span class="st"> </span>diet) </code></pre></div>
<p><img src="e-PCA_data_vis_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#exploring-data-with-pca">Exploring data with PCA</a></li>
      <li><a href="#important-commands">Important commands</a></li>
      <li><a href="#load-cleaned-data">Load cleaned data</a></li>
      <li><a href="#transformations">Transformations</a></li>
      <li><a href="#pairs-plot">Pairs plot</a></li>
      <li><a href="#pca-on-predictor-x-variables">PCA on predictor (x) variables</a></li>
      <li><a href="#pca-on-predictory-variables">PCA on predictory variables</a></li>
      <li><a href="#biplot">Biplot</a></li>
      <li>
<a href="#pca-with-response-variables">PCA with response variables</a><ul class="nav nav-pills nav-stacked">
<li><a href="#run-a-pca">Run a PCA</a></li>
      <li><a href="#make-biplot-of-response-variables">Make biplot of response variables</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
