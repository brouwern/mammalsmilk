<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
<ol start="2" style="list-style-type: lower-alpha">
<li>Data cleaning</li>
</ol> • mammalsmilk</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="&lt;ol start=" style="list-style-type: lower-alpha">
</head>
<body>
<li>Data cleaning</li>
" /&gt;

<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mammalsmilk</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-introduction.html">a) Introduction to the mammals' milk case study</a>
    </li>
    <li>
      <a href="../articles/b1-data_access.html">b) Accessing mammalsmilk data</a>
    </li>
    <li>
      <a href="../articles/b2-data_cleaning.html">b) Data cleaning</a>
    </li>
    <li>
      <a href="../articles/c-data_subsetting.html">C) Data subsetting using dplyr</a>
    </li>
    <li>
      <a href="../articles/d-data_exploration.html">d) Data Exploration for Regression Analyses</a>
    </li>
    <li>
      <a href="../articles/e-PCA_data_vis.html">e) Data visualization &amp; exploration with PCA</a>
    </li>
    <li>
      <a href="../articles/f1-linear_reg_notes.html">f1) Linear regression notes</a>
    </li>
    <li>
      <a href="../articles/f2-linear_reg_fit_plot.html">f2) Running and plotting Linear Regression </a>
    </li>
    <li>
      <a href="../articles/f3-linear_reg_model_fit.html">f3) Linear regression as model fitting</a>
    </li>
    <li>
      <a href="../articles/g-linear_reg_diagnostics.html">g) Regression diagnostics &amp; Residual Analysis</a>
    </li>
    <li>
      <a href="../articles/z-building_a_package.html">z) Creating this package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1><ol start="2" style="list-style-type: lower-alpha">
<li>Data cleaning</li>
</ol></h1>
                        <h4 class="author">Nathan Brouwer</h4>
            
            <h4 class="date">2018-11-21</h4>
      
      
      <div class="hidden name"><code>b2-data_cleaning.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In this tutorial we’ll</p>
<ul>
<li>load data from Skibiel et al 2013</li>
<li>fix some typos that were introduced during data preparation</li>
<li>clean up some columns of numeric data that contain character data</li>
<li>save the data as a .csv for future use</li>
</ul>
<div id="important-functions-used" class="section level3">
<h3 class="hasAnchor">
<a href="#important-functions-used" class="anchor"></a>Important functions used</h3>
<ul>
<li>read.csv</li>
<li>is.na</li>
<li>grep</li>
<li>gsub</li>
<li>as.numeric</li>
<li>dplyr::select</li>
<li>dplyr::rename</li>
<li>write.csv</li>
</ul>
</div>
<div id="original-data" class="section level3">
<h3 class="hasAnchor">
<a href="#original-data" class="anchor"></a>Original Data</h3>
<p><strong>Skibiel et al 2013.</strong> The evolution of the nutrient composition of mammalian milks. Journal of Animal Ecology 82: 1254-1264. <a href="https://doi.org/10.1111/1365-2656.12095" class="uri">https://doi.org/10.1111/1365-2656.12095</a></p>
</div>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div id="loading-the-mammalsmilk-package" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-the-mammalsmilk-package" class="anchor"></a>Loading the mammalsmilk package</h3>
<p>If you haven’t already, download the mammalsmilk package from GitHub (note the “S” between mammal and milk). This is commented out in the code below - only run the code if you have never downloaded it before, or haven’t recently (in case its been updated)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install_github("brouwern/mammalsmilk")</span></code></pre></div>
<p>You can then load the package with library()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mammalsmilk)</code></pre></div>
<p>We’ll start with the data in a raw form. This is most easily accessed using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"milk_raw"</span>)</code></pre></div>
<p>The originally .csv file is called “Skibiel_mammalsmilk_raw.csv”. See the preceding vignette on data access for how to find these files and tips on loading .csv files if you need to practice this.</p>
</div>
<div id="packages" class="section level3">
<h3 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h3>
<p>We’ll use the following packages. You’ll need to download them if you haven’t already. I’d try just loading them with library() first (in the next section), then installing if needed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("dplyr")</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
</div>
<div id="data-preparation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>Data preparation</h3>
<p>The raw data is from a word file of appendices from the original paper.</p>
<ul>
<li>Table S1. Milk composition of mammals at mid-lactation</li>
<li>Table S2. Ecology and life histories of mammals whose milk composition has been described</li>
</ul>
<p>I pasted the data by hand into Excel and saved it as a .csv file. Once in .csv form it can be loaded into R and further cleaned up. (In the future I will re-do this all in R).</p>
</div>
</div>
<div id="data-cleaning" class="section level2">
<h2 class="hasAnchor">
<a href="#data-cleaning" class="anchor"></a>Data cleaning</h2>
<p>The data are a bit rough because they were formatted to be a table in a paper. There’s lots of text within cells added as annotations, and probably some errors due to switching from a table in a word doc to .csv.</p>
<div id="mannually-fix-incorrect-nas" class="section level3">
<h3 class="hasAnchor">
<a href="#mannually-fix-incorrect-nas" class="anchor"></a>Mannually fix incorrect NAs</h3>
<p>There are 2 NA values in my “fat” column that shouldn’t be there; they should be valid numeric entries. I use the following code to</p>
<ul>
<li>Identify the location of the NAs with is.na()</li>
<li>Identify the specific row of data by using which() to ID the specific species with an NA for fat</li>
<li>Overwrite the NA with the correct data using row indexing
<ul>
<li>ie “dat[i.H.niger,“fat”] &lt;- 5.0”</li>
</ul>
</li>
</ul>
<p>Note that is.na() returns TRUE/FALSE values; “TRUE” acts like specific index when you use it for row indexing. So, even though “i.NA” is a vector of TRUES and FALSE, milk_raw$spp[i.NA]" returns just the two species that match the “TRUES”</p>
<p>(There are probably tidyverse ways of doing this but I haven’t looked into it.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Look at fat column</span>
<span class="kw">summary</span>(milk_raw<span class="op">$</span>fat)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##   0.200   4.575   8.550  14.068  17.575  61.100       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find NAS</span>
i.NA &lt;-<span class="st"> </span><span class="kw">is.na</span>(milk_raw<span class="op">$</span>fat)

<span class="co">#Identify the species w/ NAs</span>
milk_raw<span class="op">$</span>spp[i.NA]</code></pre></div>
<pre><code>## [1] Hippotragus niger         Cervus elaphus hispanicus
## 130 Levels: Acomys cahirinus Alces alces ... Zalophus californianus</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract the indexes of the appropriate species</span>
i.H.niger   &lt;-<span class="st"> </span><span class="kw">which</span>(milk_raw<span class="op">$</span>spp <span class="op">==</span><span class="st"> "Hippotragus niger"</span>)
i.C.elaphus &lt;-<span class="st"> </span><span class="kw">which</span>(milk_raw<span class="op">$</span>spp <span class="op">==</span><span class="st"> "Cervus elaphus hispanicus"</span>)

<span class="co">#Overwrite the bad values with correct values</span>
milk_raw[i.H.niger,<span class="st">"fat"</span>] &lt;-<span class="st"> </span><span class="fl">5.0</span>
milk_raw[i.C.elaphus,<span class="st">"fat"</span>] &lt;-<span class="st"> </span><span class="fl">12.6</span></code></pre></div>
</div>
<div id="clean-texts-from-numeric-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-texts-from-numeric-variables" class="anchor"></a>Clean texts from numeric variables</h3>
<p>There are some text annotations from the raw data still hanging out in the dataframe. I will use “regular expressions” to clean these up. Regular expression take practice to use but there are many resources online for learning about them (Cleaning up asterisks (*), as below, is even a little trickier).</p>
<p>What follows is just a brief snapshot into this feature of R. R is known, however, for not having stellar basic regular expression features. Some tools in the tidyverse are available to make things less painful, but I haven’t switched to them yet.</p>
<div id="locate-unwanted-characters-with-grep" class="section level4">
<h4 class="hasAnchor">
<a href="#locate-unwanted-characters-with-grep" class="anchor"></a>Locate unwanted characters with grep()</h4>
<p>There are letters, commas, and asterisks that were annotations in the original datafile. Easy to remove with find-replace, but also very easy with gsub(), with not chance of changing anything else in your spreadsheet you don’t want</p>
<p>Look at all of the protein column; those asterisks are a problem. There’s also an “s” in one cell.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(milk_raw<span class="op">$</span>protein)</code></pre></div>
<pre><code>##  1.1*  1.3*   1.4  1.4*   1.5  1.5*   1.6  1.6*  1.7*   1.9    10 10.2, 
##     1     2     1     1     3     1     2     4     1     1     2     1 
##  10.3  10.5  10.7    11  11.1 11.2*  11.8  11.9  12.1  12.2  12.3  12.4 
##     3     2     3     2     1     1     1     1     1     1     1     1 
##  12.5  14.6  15.8   2.1   2.2   2.5   2.6   2.7     3   3.1   3.4   3.6 
##     2     1     1     2     1     1     1     2     1     1     1     2 
##  3.9*     4   4.1  4.2*   4.3  4.3*   4.4   4.5   4.6   4.8  4.8*   4.9 
##     1     2     1     1     1     1     2     2     1     1     1     1 
##   5.1  5.2*   5.4   5.5   5.6  5.6*   5.7   5.9     6   6.2   6.3  6.3* 
##     1     1     1     1     2     1     2     1     1     1     3     1 
##   6.4   6.5   6.6   6.7   6.8   6.9     7  7.1*   7.2   7.3   7.4   7.7 
##     1     2     1     1     1     1     3     1     2     2     1     2 
##   7.8  7.8S     8   8.1  8.1*   8.2   8.4  8.4*   8.5  8.6*  8.7*   8.8 
##     1     1     2     1     1     2     1     1     1     1     1     1 
##   8.9     9   9.1   9.2  9.2*   9.4   9.5   9.7  9.9* 
##     1     2     1     1     1     2     3     1     1</code></pre>
<ul>
<li>Use grep() to find the index of things</li>
<li>“[a-zA-Z]” = “find all letter, lower and uppercase”</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i.letters &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">"[a-zA-Z]"</span>,milk_raw<span class="op">$</span>protein)

milk_raw<span class="op">$</span>protein[i.letters]</code></pre></div>
<pre><code>## [1] 7.8S
## 93 Levels: 1.1* 1.3* 1.4 1.4* 1.5 1.5* 1.6 1.6* 1.7* 1.9 10 10.2, ... 9.9*</code></pre>
<p>There’s the “S”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#these are equivalent for the simple case of a single letter</span>
i.S &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">"S"</span>,milk_raw<span class="op">$</span>protein)  <span class="co">#no brackets</span>
i.S &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">"[S]"</span>,milk_raw<span class="op">$</span>protein)<span class="co">#brackets</span>

milk_raw<span class="op">$</span>protein[i.S]</code></pre></div>
<pre><code>## [1] 7.8S
## 93 Levels: 1.1* 1.3* 1.4 1.4* 1.5 1.5* 1.6 1.6* 1.7* 1.9 10 10.2, ... 9.9*</code></pre>
</div>
</div>
<div id="replace-unwanted-characters-with-gsub" class="section level3">
<h3 class="hasAnchor">
<a href="#replace-unwanted-characters-with-gsub" class="anchor"></a>Replace unwanted characters with gsub()</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw<span class="op">$</span>protein &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"[a-zA-Z]"</span>, <span class="co">#pattern</span>
                    <span class="st">""</span>,         <span class="co">#replace</span>
                    milk_raw<span class="op">$</span>protein)<span class="co">#data</span></code></pre></div>
<p>Check</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">"[a-zA-Z]"</span>,milk_raw<span class="op">$</span>protein)</code></pre></div>
<pre><code>## integer(0)</code></pre>
</div>
<div id="use-the-gsub-command-to-replace-special-characters" class="section level3">
<h3 class="hasAnchor">
<a href="#use-the-gsub-command-to-replace-special-characters" class="anchor"></a>Use the gsub() command to replace “special” characters</h3>
<div id="asterisks" class="section level4">
<h4 class="hasAnchor">
<a href="#asterisks" class="anchor"></a>Asterisks: “*"</h4>
<ul>
<li>Asterisks are a “special character” for regular expressions</li>
<li>These can be tricky</li>
<li>Have to put \ in front of it</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw<span class="op">$</span>protein &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">*"</span>,<span class="st">""</span>,milk_raw<span class="op">$</span>protein)</code></pre></div>
<p>Check</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">*"</span>,milk_raw<span class="op">$</span>protein)</code></pre></div>
<pre><code>## integer(0)</code></pre>
</div>
<div id="commas" class="section level4">
<h4 class="hasAnchor">
<a href="#commas" class="anchor"></a>COmmas “,”</h4>
<p>Commas are also species characters</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw<span class="op">$</span>protein &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">,"</span>,<span class="st">""</span>,milk_raw<span class="op">$</span>protein)</code></pre></div>
<p>Check</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">,"</span>,milk_raw<span class="op">$</span>protein)</code></pre></div>
<pre><code>## integer(0)</code></pre>
</div>
</div>
<div id="check-for-spaces" class="section level3">
<h3 class="hasAnchor">
<a href="#check-for-spaces" class="anchor"></a>Check for spaces</h3>
<p>These are frequent typos in data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">" "</span>, milk_raw<span class="op">$</span>protein)</code></pre></div>
<pre><code>## integer(0)</code></pre>
<p>but luckily none!</p>
</div>
<div id="convert-character-data-to-numeric-data" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-character-data-to-numeric-data" class="anchor"></a>Convert character data to numeric data</h3>
<ul>
<li>Because there were non-numeric characters (S, a command, *) in the column, are loaded “protein” as character data; basically it treated it as words/symbols but not numbers.</li>
<li>We now need to convert it back to numbers</li>
<li>This is done with the command as.numeric()</li>
<li>Converting back and forth can sometimes cause problems, so its good to put the converted info in a new column to check against the old</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw<span class="op">$</span>protein.num &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(milk_raw<span class="op">$</span>protein)</code></pre></div>
<p>Compare old and new columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(milk_raw[,<span class="kw">c</span>(<span class="st">"protein.num"</span>,<span class="st">"protein"</span>)])</code></pre></div>
<pre><code>##   protein.num protein
## 1         6.3     6.3
## 2         5.7     5.7
## 3         4.1     4.1
## 4         4.3     4.3
## 5         5.6     5.6
## 6         8.8     8.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(milk_raw[,<span class="kw">c</span>(<span class="st">"protein.num"</span>,<span class="st">"protein"</span>)])</code></pre></div>
<pre><code>##     protein.num protein
## 125         6.4     6.4
## 126         8.1     8.1
## 127         4.4     4.4
## 128         8.1     8.1
## 129        10.7    10.7
## 130         9.4     9.4</code></pre>
</div>
<div id="clean-other-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-other-columns" class="anchor"></a>Clean other columns</h3>
<p>Check other columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(milk_raw[,<span class="kw">c</span>(<span class="st">"sugar"</span>,<span class="st">"energy"</span>)])</code></pre></div>
<pre><code>##      sugar        energy   
##  3      : 5   1.44   :  4  
##  4.5    : 5   0.81   :  3  
##  5.3    : 5   1.13   :  3  
##  5.2    : 4   0.49   :  2  
##  6.6    : 4   0.5    :  2  
##  (Other):92   (Other):101  
##  NA's   :15   NA's   : 15</code></pre>
<div id="sugar" class="section level4">
<h4 class="hasAnchor">
<a href="#sugar" class="anchor"></a>Sugar</h4>
<ul>
<li>The sugar column has “&lt;” and letters.<br>
</li>
<li>I can put anything I want removed inside the brackets
<ul>
<li>“[a-zA-Z&lt;]”" will get rid of the letters and “&lt;”</li>
</ul>
</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(milk_raw<span class="op">$</span>sugar)</code></pre></div>
<pre><code>## &lt;0.025   0.02   0.05    0.1    0.3    0.8      1    1.2    1.3    1.5 
##      1      2      1      1      1      1      1      1      1      1 
##    1.7    1.8   10.9     11   12.5     14    2.2    2.3    2.5    2.6 
##      2      1      1      2      2      1      1      3      2      2 
##    2.7    2.8      3    3.1    3.2    3.3    3.4    3.6    3.7    3.8 
##      3      1      5      1      1      1      3      2      1      2 
##      4    4.1    4.2    4.3    4.4    4.5    4.6    4.8    4.9    5.2 
##      2      1      1      1      3      5      2      1      2      4 
##    5.3   5.3,    5.6    5.7   5.8S    5.9    6.1    6.2    6.4    6.6 
##      5      1      1      3      1      2      1      3      3      4 
##    6.7    6.8    6.9      7    7.2    7.4    7.5    7.7    7.8    7.9 
##      2      2      2      2      1      1      1      1      3      1 
##    8.1    8.4    8.5    8.9   NA's 
##      1      1      2      1     15</code></pre>
<p>Remove letters and “&lt;”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw<span class="op">$</span>sugar &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"[a-zA-Z&lt;]"</span>,<span class="st">""</span>,milk_raw<span class="op">$</span>sugar)</code></pre></div>
<p>Convert and check</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw<span class="op">$</span>sugar.num &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(milk_raw<span class="op">$</span>sugar)</code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(milk_raw[,<span class="kw">c</span>(<span class="st">"sugar.num"</span>,<span class="st">"sugar"</span>)])</code></pre></div>
<pre><code>##   sugar.num sugar
## 1       5.2   5.2
## 2        NA  &lt;NA&gt;
## 3       5.3   5.3
## 4       4.1   4.1
## 5       4.9   4.9
## 6        NA  &lt;NA&gt;</code></pre>
</div>
<div id="energy" class="section level4">
<h4 class="hasAnchor">
<a href="#energy" class="anchor"></a>Energy</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#The followign are equivalent</span>
<span class="kw">summary</span>(milk_raw[,<span class="kw">c</span>(<span class="st">"energy"</span>)])</code></pre></div>
<pre><code>##  0.36  0.45  0.46  0.47  0.49   0.5  0.52  0.54  0.57  0.65  0.68  0.71 
##     1     1     1     1     2     2     2     1     2     1     1     1 
##  0.72  0.78  0.81  0.82  0.84   0.9  0.91  0.92  0.93  0.96  0.98  1.03 
##     1     1     3     1     1     1     2     1     1     1     1     2 
##  1.06  1.08  1.09   1.1  1.11  1.13  1.16  1.17  1.19   1.2  1.21  1.23 
##     2     1     1     1     1     3     2     2     1     1     2     1 
##  1.25  1.26  1.27  1.28  1.31  1.36  1.37  1.41  1.42  1.43  1.44  1.48 
##     1     1     1     1     1     2     2     1     1     1     4     1 
##   1.5  1.52   1.6  1.61  1.62  1.64  1.65  1.68  1.71  1.79   1.8  1.83 
##     1     2     1     1     1     1     1     1     1     2     1     1 
##  1.88  1.95  1.96     2  2.06  2.07   2.1  2.18   2.2  2.34  2.45  2.57 
##     1     1     1     1     1     1     2     1     1     1     1     1 
##  2.59  2.61  2.62  2.65  2.76  2.82  2.85  2.94  3.29   3.4  3.49  3.64 
##     1     1     1     1     1     1     1     1     1     2     1     1 
##  3.73  4.47  4.71  5.23  5.36  5.41 5.69*  5.89  NA's 
##     1     1     1     1     1     1     1     1    15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(milk_raw<span class="op">$</span>energy)</code></pre></div>
<pre><code>##  0.36  0.45  0.46  0.47  0.49   0.5  0.52  0.54  0.57  0.65  0.68  0.71 
##     1     1     1     1     2     2     2     1     2     1     1     1 
##  0.72  0.78  0.81  0.82  0.84   0.9  0.91  0.92  0.93  0.96  0.98  1.03 
##     1     1     3     1     1     1     2     1     1     1     1     2 
##  1.06  1.08  1.09   1.1  1.11  1.13  1.16  1.17  1.19   1.2  1.21  1.23 
##     2     1     1     1     1     3     2     2     1     1     2     1 
##  1.25  1.26  1.27  1.28  1.31  1.36  1.37  1.41  1.42  1.43  1.44  1.48 
##     1     1     1     1     1     2     2     1     1     1     4     1 
##   1.5  1.52   1.6  1.61  1.62  1.64  1.65  1.68  1.71  1.79   1.8  1.83 
##     1     2     1     1     1     1     1     1     1     2     1     1 
##  1.88  1.95  1.96     2  2.06  2.07   2.1  2.18   2.2  2.34  2.45  2.57 
##     1     1     1     1     1     1     2     1     1     1     1     1 
##  2.59  2.61  2.62  2.65  2.76  2.82  2.85  2.94  3.29   3.4  3.49  3.64 
##     1     1     1     1     1     1     1     1     1     2     1     1 
##  3.73  4.47  4.71  5.23  5.36  5.41 5.69*  5.89  NA's 
##     1     1     1     1     1     1     1     1    15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#clean</span>
milk_raw<span class="op">$</span>energy &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"[a-zA-Z&lt;]"</span>,<span class="st">""</span>,milk_raw<span class="op">$</span>energy)

<span class="co">#convert and check</span>
milk_raw<span class="op">$</span>energy.num &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(milk_raw<span class="op">$</span>energy)</code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(milk_raw[,<span class="kw">c</span>(<span class="st">"energy.num"</span>,<span class="st">"energy"</span>)])</code></pre></div>
<pre><code>##   energy.num energy
## 1       1.21   1.21
## 2         NA   &lt;NA&gt;
## 3       1.13   1.13
## 4       0.91   0.91
## 5       1.31   1.31
## 6         NA   &lt;NA&gt;</code></pre>
</div>
</div>
</div>
<div id="remove-unwanted-columns-with-dplyr" class="section level2">
<h2 class="hasAnchor">
<a href="#remove-unwanted-columns-with-dplyr" class="anchor"></a>Remove unwanted columns with dplyr</h2>
<p>Once we’ve checked that our data have converted properly from character to numeric, we can remove the old columns of character data using select() and negative indexing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw2 &lt;-<span class="st"> </span>milk_raw <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>dry.matter,
                                   <span class="op">-</span>protein,
                                   <span class="op">-</span>sugar,
                                   <span class="op">-</span>energy,
                                   <span class="op">-</span>ref,
                                   <span class="op">-</span>lactation.stage.orig)</code></pre></div>
<p>Note that during initial cleaning I only remove variable that are completely redundant; otherwise I leave everything in.</p>
</div>
<div id="change-elements-common-accross-column" class="section level2">
<h2 class="hasAnchor">
<a href="#change-elements-common-accross-column" class="anchor"></a>Change elements common accross column</h2>
<p>Remove “.NUM” and “.num” using gsub()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(milk_raw2) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">".NUM"</span>,<span class="st">""</span>,<span class="kw">names</span>(milk_raw2))
<span class="kw">names</span>(milk_raw2) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">".num"</span>,<span class="st">""</span>,<span class="kw">names</span>(milk_raw2))</code></pre></div>
</div>
<div id="rename-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#rename-columns" class="anchor"></a>Rename columns</h2>
<p>To polish a dataset for analysis, I like to shorten the variable names</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk_raw2 &lt;-<span class="st"> </span>milk_raw2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">fam =</span> family,
                                  <span class="dt">mass.fem =</span> mass.female,
                            <span class="dt">gest.mo =</span> gestation.month,
                            <span class="dt">lac.mo =</span> lacatation.months,
                            <span class="dt">prot =</span> protein,
                            <span class="dt">dev.birth =</span> dev.stage.at.birth,
                            <span class="dt">ord =</span> order)</code></pre></div>
<p>Let’s call this cleaned up data just “milk”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk &lt;-<span class="st"> "milk_raw2"</span></code></pre></div>
<div id="save-the-cleaned-data" class="section level3">
<h3 class="hasAnchor">
<a href="#save-the-cleaned-data" class="anchor"></a>Save the cleaned data</h3>
<p>We can save our cleaned data using read.csv()</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(milk, <span class="st">"data/skibiel_mammalsmilk.csv"</span>,
          <span class="dt">row.names =</span> F)</code></pre></div>
<p>The data produced by the above workflow are actually internal to the package. However, I recommend saving the .csv file to wherever you keep your R work and to practice reloading it.</p>
<p>You can load it directly, however, using data(“milk”)</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#preliminaries">Preliminaries</a></li>
      <li><a href="#data-cleaning">Data cleaning</a></li>
      <li><a href="#remove-unwanted-columns-with-dplyr">Remove unwanted columns with dplyr</a></li>
      <li><a href="#change-elements-common-accross-column">Change elements common accross column</a></li>
      <li><a href="#rename-columns">Rename columns</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  
</body>
</html>
